<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>充值</title>
	<link rel="stylesheet" href="css/font-awesome.min.css"/>
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/css.css">
	<script src="js/jquery-3.4.1.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/base64.js"></script>
	<script src="js/API.js"></script>
</head>
<body class="chongzhi">
	<div class="page">
		<header>
			<div class="back">
				<i class="fa fa-angle-left"></i>
			</div>
			<p>充值</p>
			<span></span>
		</header>
		<div class="empty"></div>
		<div class="chongzhi">
			<!--<div class="choose_bank">-->
				<!--<div class="img">-->
					<!--<i class="fa fa-bank"></i>-->
				<!--</div>-->
				<!--&lt;!&ndash;<select>&ndash;&gt;-->
					<!--&lt;!&ndash;<option value="">&ndash;&gt;-->
						<!--&lt;!&ndash;交通银行&ndash;&gt;-->
						<!--&lt;!&ndash;&nbsp;&nbsp;&nbsp;&nbsp;&ndash;&gt;-->
						<!--&lt;!&ndash;&nbsp;&nbsp;&nbsp;&nbsp;&ndash;&gt;-->
						<!--&lt;!&ndash;尾号5029&ndash;&gt;-->
					<!--&lt;!&ndash;</option>&ndash;&gt;-->
				<!--&lt;!&ndash;</select>&ndash;&gt;-->
			<!--</div>-->
			<div class="copy">
				<div class="png">
					<p>收款户名: <span id="accountName"> &nbsp;</span></p>
					<p>收款银行: <span id="bankName"> &nbsp;</span></p>
					<p>收款账号: <span id="bankCard"> &nbsp;</span>&nbsp;&nbsp;&nbsp;<button >复制</button></button></p>
                    <p>充值金额: <span id="orderMoney"> &nbsp;</span></p>
                    <p>匹配金额: <span style="color: #c91e1c;size: 50px" id="distributionMoney"> &nbsp;</span><span style="color: #c91e1c;size: 50px">  &nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;    ***按该金额进行充值</span></p>
				</div>
			</div>
			<div class="input">
				<div class="upload_img">
                    <h4>提交图片</h4>
                    <div class="img">
                    </div>
                </div>
				<div class="btn1">
					<button>提交</button>
				</div>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript">
    $(function(){
        var test =window.location.href;
        var money=test.split("?money=");
        if(money[1]==undefined||money[1]=="undefined"){
			alert("请选择需要充值的金额，再进行信息拉取");
            window.location.href='invest_money.html';
		}else{
            queryBankInfo(money[1]);
		}

        $(function(){
            $(".back").on('click', function()  {
                history.back(-1);
            });
        })


		function queryBankInfo(money) {
            let timestamp = Date.parse(new Date());
            let base64 = `{"token": "111111","orderMoney":"${money}","agtVer":${publicMap.get("agtVer")},"clientVer":${publicMap.get("clientVer")},"clientType":${publicMap.get("clientType")},"ctime": ${timestamp}}`;
            //        let base64 = `{"token": "${storage.getItem("yf_token")}","acType": ${acType},"businessType": ${businessType},"mmQrCode": "${mmQrCode}","wxQrCodeAds": "${wxQrCodeAds}","payee": "${payee}","acNum": "${acNum}","acName": "${acName}","password": "${password}","agtVer":${publicMap.get("agtVer")},"clientVer":${publicMap.get("clientVer")},"clientType":${publicMap.get("clientType")},"ctime": ${timestamp}}`;
            console.log("参数："+base64);
            let base = new Base64();
            let result = base.encode(base64);
            let jsonData = JSON.stringify({"jsonData":result});
            $.ajax({
                url: API+'/fine/recharge/add',
                type: 'post',
                dataType: 'json',
                contentType:"application/json",
                data:jsonData,
                // 成功执行
                success (data) {
                    let code = data.resultCode;
                    if(code !== "0"){
                        alert(data.message);
                    }else {
                        let base64 = data.data.jsonData;
                        let base = new Base64();
                        let rsData= base.decode(base64);
                        let rsDataJson = JSON.parse(rsData);

                        Callback(rsDataJson.recharge);
                    }
                }
            })
        }


        function Callback(data) {
            console.log(data);
            if(data.length!=0){
                $("#accountName").html(data.accountName);
                $("#bankName").html(data.bankName);
                $("#bankCard").html(data.bankCard);
                $("#orderMoney").html(data.orderMoney);
                $("#distributionMoney").html(data.distributionMoney);
            }
        }
    })
	let copy = $('.chongzhi .copy .png p');
</script>
</html>